# Full-Stack DevOps Chat Application

A real-time chat application with complete DevOps automation using Docker, Kubernetes, and Ansible.

## ğŸš€ Quick Start

### Deploy Entire Stack (Kubernetes)

```bash
cd walter-backend/ansible
ansible-playbook -i inventory master.yaml
```

This single command will:
- Build Docker images for frontend and backend
- Deploy containers locally
- Start Minikube
- Deploy to Kubernetes
- Expose services via NodePort

### Access the Application

**Frontend:**
```bash
minikube service chat-frontend
```
Or visit: `http://192.168.49.2:32484`

**Backend API:**
```bash
minikube service chat-backend --url
```
Or visit: `http://192.168.49.2:30948`

---

## ğŸ“¦ Local Development

### Using Docker Compose

```bash
# Start all services
docker-compose up -d

# View logs
docker-compose logs -f

# Stop all services
docker-compose down
```

Access:
- **Frontend**: http://localhost:5173
- **Backend**: http://localhost:5001
- **MongoDB**: localhost:27017

---

## ğŸ—ï¸ Project Structure

```
devops-EL/
â”œâ”€â”€ walter-frontend/           # React/Vite frontend
â”‚   â”œâ”€â”€ Dockerfile            # Multi-stage build
â”‚   â”œâ”€â”€ nginx.conf            # API proxy config
â”‚   â”œâ”€â”€ deployment.yaml       # K8s deployment
â”‚   â””â”€â”€ service.yaml          # K8s service
â”‚
â”œâ”€â”€ walter-backend/           # Node.js/Express backend
â”‚   â”œâ”€â”€ Dockerfile
â”‚   â”œâ”€â”€ deployment.yaml
â”‚   â”œâ”€â”€ service.yaml
â”‚   â””â”€â”€ ansible/              # Automation playbooks
â”‚       â”œâ”€â”€ master.yaml       # Main orchestrator
â”‚       â”œâ”€â”€ build.yaml        # Backend image build
â”‚       â”œâ”€â”€ build-frontend.yaml
â”‚       â”œâ”€â”€ docker-deploy.yaml
â”‚       â”œâ”€â”€ docker-deploy-frontend.yaml
â”‚       â”œâ”€â”€ k8s-deploy.yaml   # K8s deployment
â”‚       â”œâ”€â”€ vars.yaml         # Configuration
â”‚       â””â”€â”€ inventory         # Ansible hosts
â”‚
â””â”€â”€ docker-compose.yaml       # Local dev stack
```

---

## ğŸ› ï¸ DevOps Architecture

### Containerization
- **Frontend**: Multi-stage build (Node.js â†’ nginx) = 64.8MB
- **Backend**: Node.js with dependencies = 1.21GB
- **Both**: Optimized with .dockerignore

### Kubernetes Deployment
- **Frontend**: 2 replicas, NodePort service
- **Backend**: 2 replicas, NodePort service
- **High Availability**: Auto-healing, rolling updates

### Ansible Automation
- Infrastructure as Code
- Idempotent playbooks
- Modular task organization

---

## ğŸ“‹ Available Commands

### Build Docker Images

```bash
# Frontend
cd walter-frontend
docker build -t chat-frontend:1.0 .

# Backend
cd walter-backend
docker build -t chat-backend:1.0 .
```

### Kubernetes Operations

```bash
# View pods
kubectl get pods

# View services
kubectl get svc

# View deployments
kubectl get deployments

# Scale deployment
kubectl scale deployment chat-frontend --replicas=3

# View logs
kubectl logs -f deployment/chat-frontend
```

### Ansible Playbooks

```bash
cd walter-backend/ansible

# Build images only
ansible-playbook -i inventory build.yaml
ansible-playbook -i inventory build-frontend.yaml

# Deploy containers only
ansible-playbook -i inventory docker-deploy.yaml
ansible-playbook -i inventory docker-deploy-frontend.yaml

# K8s deployment only
ansible-playbook -i inventory k8s-deploy.yaml

# Complete deployment
ansible-playbook -i inventory master.yaml
```

---

## ğŸ”§ Configuration

### Frontend Environment Variables

Create `.env` in `walter-frontend/`:

```env
VITE_API_URL=http://localhost:3000/api
```

### Backend Environment Variables

Configure `.env` in `walter-backend/`:

```env
PORT=3000
MONGO_URI=your_mongodb_uri
NODE_ENV=production
# Add other configuration variables
```

### Ansible Variables

Edit `walter-backend/ansible/vars.yaml`:

```yaml
# Backend
image_name: chat-backend
image_tag: "1.0"
container_name: chat-backend
host_port: 5001
container_port: 3000

# Frontend
frontend_image_name: chat-frontend
frontend_image_tag: "1.0"
frontend_container_name: chat-frontend
frontend_host_port: 8080
frontend_container_port: 80
```

---

## ğŸ¯ Features

### Application
- âœ… Real-time messaging with Socket.io
- âœ… User authentication
- âœ… Group chat support
- âœ… Contact management
- âœ… File sharing capabilities

### DevOps
- âœ… Automated Docker builds
- âœ… Multi-stage optimized images
- âœ… Kubernetes orchestration
- âœ… Infrastructure as Code (Ansible)
- âœ… Single-command deployment
- âœ… High availability (2 replicas)
- âœ… Service discovery
- âœ… API proxy and WebSocket support

---

## ğŸ“– Documentation

- **Implementation Plan**: See planning artifacts in `.gemini/antigravity/brain/`
- **Detailed Walkthrough**: Complete deployment documentation available
- **Task Tracking**: Task breakdown and progress tracking

---

## ğŸ¤ Contributing

1. Make your changes
2. Test locally with Docker Compose
3. Deploy to Kubernetes using Ansible
4. Verify all services are running

---

## ğŸ“„ License

This project is part of a DevOps college project.

---

## ğŸ™‹ Support

For deployment issues:

1. Check pod status: `kubectl get pods`
2. View logs: `kubectl logs -f deployment/chat-frontend`
3. Verify images: `docker images | grep chat-`
4. Check Minikube: `minikube status`

---

**Made with â¤ï¸ using Docker, Kubernetes, and Ansible**
